CPS1PSP/CPS2PSP 変更点

----------------------------------------------------------------------
1.66

・キャッシュを使用してメモリを限界まで使用している関係上、面倒で後回し
  にしていましたが、state saveの実行速度を向上を行いました。

・Video Syncオプションの動作を変更。完全にVsyncを待つとどうしても、
  実行速度が低下してしまうため、可能な時のみVsyncを待つように変更。
  このため、キャッシュを頻繁に読み込んだり、負荷がかかる処理を行う
  場合は、Video Sync = Offと同じ動作になるためティアリングが発生
  しますが、多くのゲームでは大分発生回数が減ると思います。
  常にOnでも問題ないかもしれませんので試してみてください。

----------------------------------------------------------------------
1.65

CPS2 Shockが更新されたので、ゲームを追加しておきました。
あと、

<共通>
・rominfo.cps1とzipname.cps1、rominfo.cps2とzipname.cps2を更新。
  (以降はこれらを更新しても書きませんので、ファイル日付が更新されて
  いたら常に置き換えるようにしてください。)

・RELEASEフラグを有効にしてコンパイルした場合は、bootleg setをリストに
  表示しないようにしました。また、RELEASEフラグを無効にした場合は
  bootleg setを黄色で表示するようにしました。

・サウンドのミキシング処理を変更。まだ変更し始めたばかりで、年明けに
  手を加えてから変更する予定でしたが、ついでなので組み込んでおきました。
  また、上記の変更に伴い、メンテナンスが面倒なのでサウンドテストをソース
  から削除。必要な場合は古いソースをダウンロードしてコンパイルしてください。
  (そのまま現行のソースに組み込むことはできません。)

・最適化オプションを-O3から-O2に変更。
  gccの最適化の影響で、-O3だとスプライトが一部描画されない現象が発生する
  場合があります。調べてみたところ、sceGuDrawArray直前のmemcpyが最適化に
  よってインライン展開された場合に、キャッシュからデータが書き込まれず
  問題が発生する模様。実行前にライトバックしてもいいんですが、ちょっと
  速度が低下したので無難な-O2に変更ということで。

<CPS1PSP>
・コンパイル時にmakefileのRELEASEフラグを削除することで、いくつかの
  bootleg setが動作するようにソースを変更。(個人的に、こんなものはゲーム
  ではないと思ってますので、動作確認は行っていません。動かなくても直す
  気はさらさらないので、その点はご了承ください。)
  CPS2PSPと同様にbootleg setを有効にしたバイナリは個人での使用に留め、
  Web等で配布しないでください。

<CPS2PSP>
・Puzz Loop 2 (Euro 010302)とHyper Street Fighter II (Asia 040202)
  に対応(したつもり)。
  rominfo.cps2のCRCをWinKawaksの出力したリストのCRCにあわせただけなので、
  もしかしたら動作しないかもしれません。動作確認できないので、動作しな
  かった場合には各自で対応してください。
  Puzz Loop 2はpuzloop2.zip、Hyper Street Fighter IIはhsf2a.zipです。
  pzloop2jのParent Setがpuzloop2に変更されましたが、そのまま使用
  できますので、特にファイル名の変更を行う必要はありません。

----------------------------------------------------------------------
1.64.5

<CPS1PSP>
・ロストワールドのフリーズ修正。

----------------------------------------------------------------------
1.64.4

<CPS1PSP>
・レイヤー1のレイヤー分割描画処理のバグを修正。

----------------------------------------------------------------------
1.64.3

・コンパイル時のワーニングを厳しくしました。
  それに合わせてワーニングが表示されなくなるようソースを修正。

<CPS2PSP>
・実験的にメインメモリに一部テクスチャを確保してましたが、多く確保
  しても効果が無いので元に戻しました。
・hsf2dがRELEASEフラグが有効でも起動できていたので、有効の時には
  ROMチェック時にはじくようにしました。
  (RELEASEフラグが有効だと、メモリの処理にパッチが当たらないので、
  正しく描画できません。)

----------------------------------------------------------------------
1.64.2

・Makefileをさらに変更。
  古いソースに上書きでも問題ありませんが、一度古いソースは削除して、
  新しいファイルをコピーした方がいいでしょう。
  PSPDev for Win32で make kxploit と make SCEkxploit が動作するように
  なったと思います。

----------------------------------------------------------------------
1.64.1

<CPS1PSP>
・パレット更新にバグがあったため修正。

----------------------------------------------------------------------
1.64

・PSPDev for Win32を利用したコンパイル方法をホームページに掲載。
  MakefileをPSPDev for Win32でも確実にコンパイルできるように変更。

<CPS2PSP>
・描画処理を最適化中。
・EEPROMの処理を少し変更したため、state dataの互換性がなくなりました。

----------------------------------------------------------------------
1.63 - CPS1PSPのバグ修正

<CPS1PSP>
・1.62で発生したメモリ解放時にフリーズするバグを修正。
・スクロール2のフォアグラウンドレイヤーが正しく描画できなくなっていた
  バグを修正(1.60からのバグ)。

----------------------------------------------------------------------
1.62
<CPS2PSP>
・スプライトのマスキング処理を正しくエミュレーションで行うよう変更。
  1.61までは、romcnv_cps2.exeで先に作成しておいたフラグを使用して処理を
  行っていましたが、この変更により必要なくなりました。
  もし、これまで修正漏れのマスキング処理があったとしても、今回の変更に
  より直ったのではないかと思います。

・上記に伴い、romcnv_cps2.exeをver.9.1に更新。
  不要になったコードを削除し、hsf2aのキャッシュファイル作成を解禁した
  だけなので、キャッシュファイルを再作成する必要はありません。

・Hyper Street Fighter II: The Anniversary Edition (Phoenix Edition)を
  動作可能にしました。bootleg(Hack?)なので、通常のコンパイルでは削除
  されます。makefileのRELEASEフラグを無効にしてコンパイルしてください。
  ※hsf2dを有効にしたバイナリは、個人使用にとどめてください。

※Hyper Street Fighter II: The Anniversary Edition (Phoenix Edition)
  について追記。書いたつもりで書いてなかった。
  Parent set: hsf2a.zip - XORテーブルが無いので動作しません。
   Clone set: hsf2j.zip - XORテーブルが無いので動作しません。
   Clone set: hsf2d.zip - ハック版。対応したのはこれです。

  hsf2a.zip                hsf2j.zip
    + hs2.01                 + hs2j.03
    + hs2.02                 + hs2j.04
    + hs2a.03                + hs2jx.03 - NO_DUMP
    + hs2a.04                + hs2jx.04 - NO_DUMP
    + hs2ax.03 - NO_DUMP     + hs2j.07
    + hs2ax.04 - NO_DUMP
    + hs2.05
    + hs2.06
    + hs2.07               hsf2d.zip
    + hs2.08                 + hs2a.03d
    + hs2.09                 + hs2a.04d
    + hs2.10
    + hs2.11m
    + hs2.13m
    + hs2.15m
    + hs2.17m
    + hs2.19m

  以上のようです。他人のソースをそのまま移植しただけなので、
  上記が正しいかどうかはわかりません。

----------------------------------------------------------------------
1.61
<CPS2PSP>
・X-MEN VS. Street Fighterで床が破壊されて落下したあと、画面が正常に
  表示されなくなっていたバグを修正。

----------------------------------------------------------------------
1.60
<CPS2PSP>
・無圧縮のキャッシュファイルの形式を再変更。
  遅くなったと感じる場合があったようですが、おそらく原因は半端なサイズの
  ヘッダが付いたために、データがFATのクラスタの途中から始まってしまうように
  なってしまったことが原因のようです。
  対応策としてromcnv_cps2.exeをver.9に更新し、無圧縮キャッシュファイルの
  データのファイル内部の位置を64KBに合わせて配置するように変更しました。
  お手数ですが無圧縮キャッシュは再度作成してください。
  (ver.8で作成したものはバージョン不一致で読み込みません)
・ラインスクロール描画のコードを最適化。ソースコードも処理を簡略化しました。

<CPS1PSP>
・描画処理のコードの処理をCPS2PSPと同様に簡略化しました。

-------------------------------------------------------------------------------
1.51
・CPS2PSPの無圧縮のキャッシュファイルの形式を変更。
  romcnv_cps2.exeをver.8に更新。

-------------------------------------------------------------------------------
1.41
・日本語フォント読み込み処理を少し変更。

-------------------------------------------------------------------------------
1.30
・フォルダに展開した無圧縮のキャッシュファイルに対応。

-------------------------------------------------------------------------------
1.21
・ストリートファイターZERO3のマスキング処理のチェックを以前のものに戻しました。
  全部チェックしてるわけじゃないので、気付かず。

-------------------------------------------------------------------------------
1.20
・スプライト管理処理を書き直したところ、予想していたよりも効果があったので
  更新しました。
  CPS2で微妙に60fpsに届かなかった、Street Fighter IIXのT.Hawkステージなども
  60fpsで動作するようになったようです。
  (もちろん、333MHzでVsync Off/Raster Effects Offが前提ですが)
  Street Fighter ZeroあたりはRaster Effects Onでも十分遊べるかも。

-------------------------------------------------------------------------------
1.13
・CPS2の一部ゲームで、コインが投入できなくなっていたバグを修正。
  (ver.1.02から発生していたと思われます。)

-------------------------------------------------------------------------------
1.12
・ステートデータのバージョンチェックを追加。(ソースの統合時に一時削除して、
  そのまま放置したままになってました。)

-------------------------------------------------------------------------------
1.11
・テクスチャのVRAMへの登録処理をちょっと変更。

-------------------------------------------------------------------------------
1.10
・CPS2の描画処理をGUのDepthBufferを使用するように変更。
  gigawing、progear、dimahoo等の画面全体でマスキング処理が行われるゲームで
  若干速度が向上したかもしれません。
・CPS2のいくつかのゲームでマスキング描画が正しく行われていない部分があったため、
  キャッシュファイルのマスキング用フラグを更新。
・CPS2のタイマ処理を簡略化。
・CPS1/CPS2でコインカウンタもステートデータに記録するように変更。
・C68K、CZ80を更新。
・PSPのビデオ処理関数を若干変更、それに伴う処理も変更。
・使用していないテーブル等を削除し、空きメモリを少し増やしました。
・メニューの綴りを一部修正。
・デバッグ用の余分なコードが混入していたので削除。
・一部の関数名を変更。(処理はそのまま)

-------------------------------------------------------------------------------
1.02
・正式なものとしては最終リリースとなります。
  以降は現在未使用のPSPの機能の実験のみ行う予定です。(主にCPS2で実験)
